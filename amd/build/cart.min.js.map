{"version":3,"sources":["../src/cart.js"],"names":["countdownelement","interval","maxitems","itemsleft","buttoninit","id","component","console","log","addtocartbutton","document","querySelector","remove","spanlabel","classList","shoppingcart","cartitem","add","addEventListener","event","contains","preventDefault","stopPropagation","addItem","init","expirationdate","cfgmaxitems","count","parseInt","initTimer","querySelectorAll","forEach","item","addDeleteevent","deleteAllItems","Ajax","call","methodname","args","done","total","innerHTML","itemcount1","getElementById","itemcount2","btn","fail","ex","deleteItem","itemprice","dataset","price","innerHTM","Notification","addNotification","message","type","data","name","Templates","renderForPromise","then","html","lastElem","insertAdjacentHTML","badge","itemid","clearInterval","idarray","split","pop","startTimer","duration","display","timer","minutes","seconds","setInterval","textContent","delta","now","Date","getTime"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package    local_shopping_cart\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport Templates from 'core/templates';\nimport Notification from 'core/notification';\n\n\nexport var countdownelement = null;\nexport var interval = null;\nexport var maxitems = null;\nexport var itemsleft = null;\nexport const buttoninit = (id, component) => {\n\n    // eslint-disable-next-line no-console\n    console.log('initialized', id, component);\n\n    // First we get the button and delete the helper-span to secure js loading.\n    const addtocartbutton = document.querySelector('#btn-' + component + '-' + id);\n\n    // If we don't find the button, we abort.\n    if (!addtocartbutton) {\n        return;\n    }\n\n    // We remove the backup span element, as we don't need it anymore.\n    addtocartbutton.querySelector('.loadJavascript').remove();\n    // We show the potentially hidden second span element with the button text.\n    const spanlabel = addtocartbutton.querySelector('span');\n    if (spanlabel) {\n        spanlabel.classList.remove('hidden');\n    }\n\n    // Make sure item is not yet in shopping cart. If so, add disabled class.\n    const shoppingcart = document.querySelector('#nav-shopping_cart-popover-container');\n    if (shoppingcart) {\n        const cartitem = shoppingcart.querySelector('#item-' + component + '-' + id);\n        if (cartitem) {\n            addtocartbutton.classList.add('disabled');\n        }\n    }\n    // Add click eventlistern to oneself.\n    addtocartbutton.addEventListener('click', event => {\n        // If we find the disabled class, the click event is aborted.\n        if (addtocartbutton.classList.contains('disabled')) {\n            return;\n        }\n        event.preventDefault();\n        event.stopPropagation();\n        addItem(id, component);\n    });\n};\n\n/**\n *\n * @param {*} expirationdate\n * @param {*} cfgmaxitems\n * @param {*} count\n */\n\n export const init = (expirationdate, cfgmaxitems, count) => {\n    countdownelement = document.querySelector('.expirationdate');\n    maxitems = cfgmaxitems;\n    count = parseInt(count) ? parseInt(count) : 0;\n    itemsleft = maxitems - count;\n    console.log(maxitems + \" \" + itemsleft);\n    initTimer(expirationdate);\n    document.querySelectorAll('.fa-trash-o').forEach(item => {\n        addDeleteevent(item);\n    });\n};\n\nexport const deleteAllItems = () => {\n    Ajax.call([{\n        methodname: \"local_shopping_cart_delete_all_items_from_cart\",\n        args: {\n        },\n        done: function() {\n            let item = document.querySelectorAll('[id^=item-]');\n            item.forEach(item => {\n                if (item) {\n                    item.remove();\n                }\n            });\n            itemsleft = maxitems;\n            let total = document.querySelectorAll('#totalprice');\n            total.forEach(total => {\n                total.innerHTML = 0;\n            });\n            let itemcount1 = document.getElementById(\"countbadge\");\n            let itemcount2 = document.getElementById(\"itemcount\");\n\n            itemcount1.innerHTML = 0;\n            itemcount2.innerHTML = 0;\n            itemcount2.classList.add(\"hidden\");\n\n            // Make sure addtocartbutton active againe once the item is removed from the shopping cart.\n            const addtocartbutton = document.querySelectorAll('[id^=btn-].disabled');\n            addtocartbutton.forEach(btn => {\n                if (btn) {\n                    btn.classList.remove('disabled');\n                }\n            });\n        },\n        fail: function(ex) {\n            console.log(ex);\n        },\n    }]);\n};\n\nexport const deleteItem = (id, component) => {\n    Ajax.call([{\n        methodname: \"local_shopping_cart_delete_item\",\n        args: {\n            'itemid': id,\n            'component': component\n        },\n        done: function() {\n            // eslint-disable-next-line no-console\n            itemsleft = itemsleft + 1;\n            console.log(id);\n            let item = document.querySelectorAll('#item-' + component + '-' + id);\n            let itemprice = item[0].dataset.price;\n            item.forEach(item => {\n                if (item) {\n                    item.remove();\n                }\n            });\n            let total = document.querySelectorAll('#totalprice');\n            total.forEach(total => {\n                total = total == \"undefined\" ? total = 0 : total;\n                total.innerHTML -= itemprice;\n            });\n            let itemcount1 = document.getElementById(\"countbadge\");\n            let itemcount2 = document.getElementById(\"itemcount\");\n\n            itemcount1.innerHTM = itemcount1.innerHTML > 0 ? itemcount1.innerHTML -= 1 : itemcount1.innerHTML;\n            itemcount2.innerHTML = itemcount2.innerHTML > 0 ? itemcount2.innerHTML -= 1 : itemcount1.innerHTML;\n            itemcount2.innerHTML = itemcount2.innerHTML == 0 ? itemcount2.classList.add(\"hidden\") : itemcount2.innerHTML;\n            // Make sure addtocartbutton active againe once the item is removed from the shopping cart.\n            const addtocartbutton = document.querySelector('#btn-' + component + '-' + id);\n            if (addtocartbutton) {\n                addtocartbutton.classList.remove('disabled');\n            }\n        },\n        fail: function(ex) {\n            // eslint-disable-next-line no-console\n            console.log(id, ex);\n            let item = document.querySelector('#item-' + component + '-' + id);\n            if (item) {\n                item.remove();\n                let itemcount1 = document.getElementById(\"countbadge\");\n                let itemcount2 = document.getElementById(\"itemcount\");\n                itemcount1.innerHTML = itemcount1.innerHTML > 0 ? itemcount1.innerHTML -= 1 : itemcount1.innerHTML;\n                itemcount2.innerHTML = itemcount2.innerHTML > 0 ? itemcount2.innerHTML -= 1 : itemcount1.innerHTML;\n                itemcount2.innerHTML = itemcount2.innerHTML == 0 ? itemcount2.classList.add(\"hidden\") : itemcount2.innerHTML;\n                let itemprice = item.dataset.price;\n                let total = document.getElementById('totalprice');\n                total = total == \"undefined\" ? total = 0 : total;\n                total.innerHTML -= itemprice;\n            }\n        },\n    }]);\n};\n\nexport const addItem = (id, component) => {\n    console.log(itemsleft);\n    if (itemsleft == 0) {\n        Notification.addNotification({\n            message: \"Cart is full\",\n            type: \"danger\"\n        });\n        return;\n    }\n    Ajax.call([{\n        methodname: \"local_shopping_cart_add_item\",\n        args: {\n            'component': component,\n            'itemid': id\n        },\n        done: function(data) {\n            data.component = component;\n            data.id = id;\n            Notification.addNotification({\n                message: data.name + \" added to cart\",\n                type: \"success\"\n            });\n            Templates.renderForPromise('local_shopping_cart/shopping_cart_item', data).then(({html}) => {\n                let lastElem = document.getElementById('litotalprice');\n                lastElem.insertAdjacentHTML('beforeBegin', html);\n                document.getElementById(\"countbadge\").innerHTML++;\n                const badge = document.getElementById(\"itemcount\");\n                badge.innerHTML = (parseInt(badge.innerHTML) || 0) + 1;\n                badge.classList.remove('hidden');\n                let total = document.getElementById('totalprice');\n                total.innerHTML = (parseInt(total.innerHTML) || 0) + parseInt(data.price);\n                let item = document.querySelector('#item-' + component + '-' + data.itemid + ' .fa-trash-o');\n                itemsleft -= 1;\n                addDeleteevent(item);\n                clearInterval(interval);\n                initTimer(data.expirationdate);\n\n                // Make sure addtocartbutton is disabled once the item is in the shopping cart.\n                const addtocartbutton = document.querySelector('#btn-' + component + '-' + data.itemid);\n                if (addtocartbutton) {\n                    addtocartbutton.classList.add('disabled');\n                }\n            });\n        },\n        fail: function(ex) {\n            // eslint-disable-next-line no-console\n            console.log('error', ex);\n        }\n    }], true);\n};\n\n/**\n * Delete Event.\n * @param {HTMLElement} item\n */\nfunction addDeleteevent(item) {\n    item.addEventListener('click', event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        // eslint-disable-next-line no-console\n        console.log('delete clicked', item.dataset.id);\n\n        let idarray = item.dataset.id.split('-');\n\n        let id = idarray.pop();\n        let component = idarray.pop();\n        deleteItem(id, component);\n    });\n}\n\n\n\n/**\n * Start the timer.\n *\n * @param {integer} duration\n * @param {integer} display\n */\nfunction startTimer(duration, display) {\n\n    var timer = duration,\n                minutes,\n                seconds;\n    interval = setInterval(function() {\n\n        minutes = parseInt(timer / 60, 10);\n        seconds = parseInt(timer % 60, 10);\n\n        minutes = minutes < 10 ? \"0\" + minutes : minutes;\n        seconds = seconds < 10 ? \"0\" + seconds : seconds;\n        console.log(minutes + \" \" + seconds);\n        display.textContent = minutes + \":\" + seconds;\n\n        if (--timer < 0) {\n            deleteAllItems();\n            console.log(\"delete\");\n            clearInterval(interval);\n        }\n    }, 1000);\n}\n\n\n/**\n * Initialize Timer.\n *\n * @param {integer} expirationdate\n *\n */\nfunction initTimer(expirationdate) {\n        if(interval) {\n            clearInterval(interval);\n        }\n        let delta = 0;\n        let now = Date.now('UTC');\n        now = (new Date()).getTime() / 1000;\n        delta = (expirationdate - now);\n        console.log(delta);\n        if (delta < 0) {\n            delta = 0;\n        }\n        startTimer(delta, countdownelement);\n}\n\n/**\n * Set dataset from timer.\n *\n * @param {integer} expirationdate\n */\nfunction setExpirationDate(expirationdate) {\n    document.querySelectorAll('.expirationdate').forEach(timer => {\n        timer.dataset.expirationdate = expirationdate;\n    });\n}\n"],"file":"cart.min.js"}