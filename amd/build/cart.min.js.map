{"version":3,"sources":["../src/cart.js"],"names":["countdownelement","interval","visbilityevent","reloadAllButtons","addtocartbuttons","document","querySelectorAll","forEach","button","classList","remove","buttoninit","id","component","buttons","number","split","pop","console","log","addtocartbutton","querySelector","shoppingcart","cartitem","add","addEventListener","event","contains","preventDefault","stopPropagation","addItem","init","expirationdate","initTimer","items","item","addDeleteevent","visibilityState","reinit","Ajax","call","methodname","args","done","data","Templates","renderForPromise","then","html","container","insertAdjacentHTML","itemid","itemcomponent","deleteaction","itemcount","getElementById","innerHTML","count","catch","e","fail","ex","deleteAllItems","total","itemcount1","itemcount2","btn","deleteItem","itemprice","dataset","price","innerHTM","clearInterval","success","Notification","addNotification","message","type","setTimeout","notificationslist","notificatonelement","length","itemname","lastElem","badge","parseInt","idarray","startTimer","duration","display","timer","minutes","seconds","setInterval","textContent","delta","now","Date","getTime"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package    local_shopping_cart\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport Templates from 'core/templates';\nimport Notification from 'core/notification';\n\nexport var countdownelement = null;\nexport var interval = null;\nexport var visbilityevent = false;\n\nexport const reloadAllButtons = () => {\n    const addtocartbuttons = document.querySelectorAll('[id^=btn-]');\n    addtocartbuttons.forEach(button => {\n        button.classList.remove('disabled');\n    });\n};\n\nexport const buttoninit = (id, component) => {\n\n    // If there is no id, we browse the whole document and init all buttons individually.\n    if (!id) {\n\n        const buttons = document.querySelectorAll(\"[id^='btn-\" + component + \"']\");\n\n        buttons.forEach(button => {\n            // We have to get only the last part of the id, the number.\n            const number = button.id.split(/[\\s-]+/).pop();\n\n            // eslint-disable-next-line no-console\n            console.log(number);\n            buttoninit(number, component);\n        });\n        return;\n    }\n\n    // First we get the button and delete the helper-span to secure js loading.\n    const addtocartbutton = document.querySelector('#btn-' + component + '-' + id);\n\n    // If we don't find the button, we abort.\n    if (!addtocartbutton) {\n        return;\n    }\n\n    // Make sure item is not yet in shopping cart. If so, add disabled class.\n    const shoppingcart = document.querySelector('#nav-shopping_cart-popover-container');\n    if (shoppingcart) {\n        const cartitem = shoppingcart.querySelector('#item-' + component + '-' + id);\n        if (cartitem) {\n            addtocartbutton.classList.add('disabled');\n        }\n    }\n    // Add click eventlistern to oneself.\n    addtocartbutton.addEventListener('click', event => {\n        // If we find the disabled class, the click event is aborted.\n        if (addtocartbutton.classList.contains('disabled')) {\n            return;\n        }\n        event.preventDefault();\n        event.stopPropagation();\n        addItem(id, component);\n    });\n};\n\n/**\n *\n * @param {*} expirationdate\n */\n\n export const init = (expirationdate) => {\n    countdownelement = document.querySelector('.expirationdate');\n    initTimer(expirationdate);\n    if (visbilityevent == false) {\n        let items = document.querySelectorAll('[id^=item-] .fa-trash-o');\n        items.forEach(item => {\n            addDeleteevent(item);\n        });\n        document.addEventListener(\"visibilitychange\", function() {\n            visbilityevent = true;\n            if (document.visibilityState === 'visible') {\n                reinit();\n            }\n        });\n    }\n};\n\nexport const reinit = () => {\n    reloadAllButtons();\n    Ajax.call([{\n        methodname: \"local_shopping_cart_get_shopping_cart_items\",\n        args: {\n        },\n        done: function(data) {\n            Templates.renderForPromise('local_shopping_cart/shopping_cart_items', data).then(({html}) => {\n                document.querySelector('.shopping-cart-items').remove();\n                let container = document.querySelector('#nav-shopping_cart-popover-container .popover-region-content-container');\n                container.insertAdjacentHTML('afterbegin', html);\n                data.items.forEach(item => {\n                    buttoninit(item.itemid, item.itemcomponent);\n                });\n                let deleteaction = document.querySelectorAll('.fa-trash-o');\n                deleteaction.forEach(item => {\n                    addDeleteevent(item);\n                });\n                let itemcount = document.getElementById(\"itemcount\");\n                itemcount.innerHTML = data.count;\n                document.getElementById(\"countbadge\").innerHTML = data.count;\n                if (data.count > 0) {\n                    itemcount.classList.remove(\"hidden\");\n                } else {\n                    itemcount.classList.add(\"hidden\");\n                }\n                initTimer(data.expirationdate);\n\n                // eslint-disable-next-line no-console\n                console.log(data.count);\n                return true;\n            }).catch((e) => {\n                // eslint-disable-next-line no-console\n                console.log(e);\n            });\n        },\n        fail: function(ex) {\n            // eslint-disable-next-line no-console\n            console.log(\"ex:\" + ex);\n        },\n    }]);\n};\n\nexport const deleteAllItems = () => {\n    Ajax.call([{\n        methodname: \"local_shopping_cart_delete_all_items_from_cart\",\n        args: {\n        },\n        done: function() {\n            let item = document.querySelectorAll('[id^=item-]');\n            item.forEach(item => {\n                if (item) {\n                    item.remove();\n                }\n            });\n            let total = document.querySelectorAll('#totalprice');\n            total.forEach(total => {\n                total.innerHTML = 0;\n            });\n            let itemcount1 = document.getElementById(\"countbadge\");\n            let itemcount2 = document.getElementById(\"itemcount\");\n\n            itemcount1.innerHTML = 0;\n            itemcount2.innerHTML = 0;\n            itemcount2.classList.add(\"hidden\");\n\n            // Make sure addtocartbutton active againe once the item is removed from the shopping cart.\n            const addtocartbutton = document.querySelectorAll('[id^=btn-].disabled');\n            addtocartbutton.forEach(btn => {\n                if (btn) {\n                    btn.classList.remove('disabled');\n                }\n            });\n        },\n        fail: function(ex) {\n            // eslint-disable-next-line no-console\n            console.log(ex);\n        },\n    }]);\n};\n\nexport const deleteItem = (id, component) => {\n    Ajax.call([{\n        methodname: \"local_shopping_cart_delete_item\",\n        args: {\n            'itemid': id,\n            'component': component\n        },\n        done: function() {\n\n            let item = document.querySelectorAll('#item-' + component + '-' + id);\n            let itemprice = item[0].dataset.price;\n            item.forEach(item => {\n                if (item) {\n                    item.remove();\n                }\n            });\n            let total = document.querySelectorAll('#totalprice');\n            total.forEach(total => {\n                total = total == \"undefined\" ? total = 0 : total;\n                total.innerHTML -= itemprice;\n            });\n            let itemcount1 = document.getElementById(\"countbadge\");\n            let itemcount2 = document.getElementById(\"itemcount\");\n\n            itemcount1.innerHTM = itemcount1.innerHTML > 0 ? itemcount1.innerHTML -= 1 : itemcount1.innerHTML;\n            itemcount2.innerHTML = itemcount2.innerHTML > 0 ? itemcount2.innerHTML -= 1 : itemcount1.innerHTML;\n\n            // If we have only one item left, we set back the expiration date.\n            if (itemcount2.innerHTML == 0) {\n                itemcount2.classList.add(\"hidden\");\n\n                // We clear the countdown and set back the timer.\n                clearInterval(interval);\n                initTimer();\n            }\n\n            // Make sure addtocartbutton active againe once the item is removed from the shopping cart.\n            const addtocartbutton = document.querySelector('#btn-' + component + '-' + id);\n            if (addtocartbutton) {\n                addtocartbutton.classList.remove('disabled');\n            }\n        },\n        fail: function(ex) {\n            // eslint-disable-next-line no-console\n            console.log(id, ex);\n            let item = document.querySelector('#item-' + component + '-' + id);\n            if (item) {\n                item.remove();\n                let itemcount1 = document.getElementById(\"countbadge\");\n                let itemcount2 = document.getElementById(\"itemcount\");\n                itemcount1.innerHTML = itemcount1.innerHTML > 0 ? itemcount1.innerHTML -= 1 : itemcount1.innerHTML;\n                itemcount2.innerHTML = itemcount2.innerHTML > 0 ? itemcount2.innerHTML -= 1 : itemcount1.innerHTML;\n                itemcount2.innerHTML = itemcount2.innerHTML == 0 ? itemcount2.classList.add(\"hidden\") : itemcount2.innerHTML;\n                let itemprice = item.dataset.price;\n                let total = document.getElementById('totalprice');\n                total = total == \"undefined\" ? total = 0 : total;\n                total.innerHTML -= itemprice;\n            }\n        },\n    }]);\n};\n\nexport const addItem = (id, component) => {\n\n    Ajax.call([{\n        methodname: \"local_shopping_cart_add_item\",\n        args: {\n            'component': component,\n            'itemid': id\n        },\n        done: function(data) {\n            data.component = component;\n            data.id = id;\n\n            if (data.success == 0) {\n                Notification.addNotification({\n                    message: \"Cart is full\",\n                    type: \"danger\"\n                });\n                setTimeout(() => {\n                    let notificationslist = document.querySelectorAll('#user-notifications div.alert.alert-danger');\n                    const notificatonelement = notificationslist[notificationslist.length - 1];\n                    notificatonelement.remove();\n                }, 5000);\n                return;\n            } else if (data.success == 1) {\n                Notification.addNotification({\n                    message: data.itemname + \" added to cart\",\n                    type: \"success\"\n                });\n\n                setTimeout(() => {\n                    let notificationslist = document.querySelectorAll('#user-notifications div.alert.alert-success');\n\n                    const notificatonelement = notificationslist[notificationslist.length - 1];\n\n                    notificatonelement.remove();\n                }, 5000);\n                Templates.renderForPromise('local_shopping_cart/shopping_cart_item', data).then(({html}) => {\n                    let lastElem = document.querySelectorAll('#litotalprice');\n                    lastElem.forEach(lastElem => {\n                        lastElem.insertAdjacentHTML('beforeBegin', html);\n                    });\n                    // let lastElem = document.getElementById('litotalprice');\n                    // lastElem.insertAdjacentHTML('beforeBegin', html);\n                    document.getElementById(\"countbadge\").innerHTML++;\n                    const badge = document.getElementById(\"itemcount\");\n                    badge.innerHTML = (parseInt(badge.innerHTML) || 0) + 1;\n                    badge.classList.remove('hidden');\n                    let total = document.querySelectorAll('#totalprice');\n                    total.forEach(total => {\n                        total.innerHTML = (parseInt(total.innerHTML) || 0) + parseInt(data.price);\n                    });\n                    let items = document.querySelectorAll('#item-' + component + '-' + data.itemid + ' .fa-trash-o');\n                    items.forEach(item => {\n                        addDeleteevent(item);\n                    });\n                    clearInterval(interval);\n                    initTimer(data.expirationdate);\n\n                    // Make sure addtocartbutton is disabled once the item is in the shopping cart.\n                    const addtocartbutton = document.querySelector('#btn-' + component + '-' + data.itemid);\n                    if (addtocartbutton) {\n                        addtocartbutton.classList.add('disabled');\n                    }\n                    return true;\n                }).catch((e) => {\n                    // eslint-disable-next-line no-console\n                    console.log(e);\n                });\n            }\n        },\n        fail: function(ex) {\n            // eslint-disable-next-line no-console\n            console.log('error', ex);\n        }\n    }], true);\n};\n\n/**\n * Delete Event.\n * @param {HTMLElement} item\n */\nfunction addDeleteevent(item) {\n    item.addEventListener('click', event => {\n        event.preventDefault();\n        event.stopPropagation();\n        // Item comes as #item-booking-213123.\n        let idarray = item.dataset.id.split('-');\n        // First pop gets the id.\n        let id = idarray.pop();\n        // Second pop gets the component.\n        let component = idarray.pop();\n        deleteItem(id, component);\n    });\n}\n\n/**\n * Start the timer.\n *\n * @param {integer} duration\n * @param {integer} display\n */\nfunction startTimer(duration, display) {\n\n    var timer = duration,\n                minutes,\n                seconds;\n    interval = setInterval(function() {\n\n        minutes = parseInt(timer / 60, 10);\n        seconds = parseInt(timer % 60, 10);\n\n        minutes = minutes < 10 ? \"0\" + minutes : minutes;\n        seconds = seconds < 10 ? \"0\" + seconds : seconds;\n\n        display.textContent = minutes + \":\" + seconds;\n\n        if (--timer < 0) {\n            deleteAllItems();\n\n            clearInterval(interval);\n        }\n    }, 1000);\n}\n\n\n/**\n * Initialize Timer.\n *\n * @param {integer} expirationdate\n *\n */\nfunction initTimer(expirationdate = null) {\n    if (interval) {\n        clearInterval(interval);\n    }\n    let delta = 0;\n    let now = Date.now('UTC');\n    now = (new Date()).getTime() / 1000;\n    if (expirationdate) {\n        delta = (expirationdate - now);\n    }\n    if (delta <= 0) {\n        delta = 0;\n        countdownelement.classList.add(\"hidden\");\n    } else if (delta > 0) {\n        countdownelement.classList.remove(\"hidden\");\n        startTimer(delta, countdownelement);\n    }\n}\n\n"],"file":"cart.min.js"}