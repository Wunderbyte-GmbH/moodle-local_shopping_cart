{"version":3,"sources":["../src/cart.js"],"names":["countdownelement","interval","visbilityevent","reloadAllButtons","addtocartbuttons","document","querySelectorAll","forEach","button","classList","remove","buttoninit","id","component","buttons","number","split","pop","addtocartbutton","querySelector","dataset","initialized","console","log","shoppingcart","cartitem","add","addEventListener","event","contains","preventDefault","stopPropagation","addItem","init","expirationdate","initTimer","items","item","addDeleteevent","visibilityState","reinit","Ajax","call","methodname","args","done","data","Templates","renderForPromise","then","html","container","insertAdjacentHTML","itemid","itemcomponent","deleteaction","itemcount","getElementById","innerHTML","count","catch","e","fail","ex","deleteAllItems","updateTotalPrice","itemcount1","itemcount2","btn","deleteItem","userid","innerHTM","clearInterval","itemprice","price","buyforuser","success","Notification","addNotification","message","type","setTimeout","notificationslist","notificatonelement","length","itemname","lastElem","removeEventListener","deleteEvent","badge","parseInt","idarray","cashierssection","checkoutcart","checkouttotals","totalprice","currency","totals","total","startTimer","duration","display","timer","minutes","seconds","setInterval","textContent","delta","now","Date","getTime"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/*\r\n * @package    local_shopping_cart\r\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\nimport Ajax from 'core/ajax';\r\nimport Templates from 'core/templates';\r\nimport Notification from 'core/notification';\r\n\r\nexport var countdownelement = null;\r\nexport var interval = null;\r\nexport var visbilityevent = false;\r\n\r\nexport const reloadAllButtons = () => {\r\n    const addtocartbuttons = document.querySelectorAll('[id^=btn-]');\r\n    addtocartbuttons.forEach(button => {\r\n        button.classList.remove('disabled');\r\n    });\r\n};\r\n\r\nexport const buttoninit = (id, component) => {\r\n\r\n    // If there is no id, we browse the whole document and init all buttons individually.\r\n    if (!id) {\r\n\r\n        const buttons = document.querySelectorAll(\"[id^='btn-\" + component + \"']\");\r\n\r\n        buttons.forEach(button => {\r\n            // We have to get only the last part of the id, the number.\r\n            const number = button.id.split(/[\\s-]+/).pop();\r\n            buttoninit(number, component);\r\n        });\r\n        return;\r\n    }\r\n\r\n    // First we get the button and delete the helper-span to secure js loading.\r\n    const addtocartbutton = document.querySelector('#btn-' + component + '-' + id);\r\n\r\n    // If we don't find the button, we abort.\r\n    if (!addtocartbutton\r\n        || addtocartbutton.dataset.initialized) {\r\n            // eslint-disable-next-line no-console\r\n            console.log('button already initialized', id);\r\n        return;\r\n    } else {\r\n        // eslint-disable-next-line no-console\r\n        console.log('button not yet initialized', id);\r\n    }\r\n\r\n    // Make sure item is not yet in shopping cart. If so, add disabled class.\r\n\r\n\r\n    let shoppingcart = document.querySelector('#shopping_cart-cashiers-cart');\r\n\r\n    if (!shoppingcart) {\r\n        shoppingcart = document.querySelector('#nav-shopping_cart-popover-container');\r\n    }\r\n\r\n    if (shoppingcart) {\r\n        const cartitem = shoppingcart.querySelector('#item-' + component + '-' + id);\r\n        if (cartitem) {\r\n            addtocartbutton.classList.add('disabled');\r\n        }\r\n    }\r\n    // Add click eventlistern to oneself.\r\n    addtocartbutton.addEventListener('click', event => {\r\n\r\n         // eslint-disable-next-line no-console\r\n         console.log('button clicked', id);\r\n\r\n        // If we find the disabled class, the click event is aborted.\r\n        if (addtocartbutton.classList.contains('disabled')) {\r\n            return;\r\n        }\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        addItem(id, component);\r\n    });\r\n\r\n    addtocartbutton.dataset.initialized = true;\r\n};\r\n\r\n/**\r\n *\r\n * @param {*} expirationdate\r\n */\r\n\r\n export const init = (expirationdate) => {\r\n    countdownelement = document.querySelector('.expirationdate');\r\n    initTimer(expirationdate);\r\n    if (visbilityevent == false) {\r\n        let items = document.querySelectorAll('[id^=item-] .fa-trash-o');\r\n        items.forEach(item => {\r\n            addDeleteevent(item);\r\n        });\r\n        document.addEventListener(\"visibilitychange\", function() {\r\n            visbilityevent = true;\r\n            if (document.visibilityState === 'visible') {\r\n                reinit();\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\nexport const reinit = () => {\r\n    reloadAllButtons();\r\n    Ajax.call([{\r\n        methodname: \"local_shopping_cart_get_shopping_cart_items\",\r\n        args: {\r\n        },\r\n        done: function(data) {\r\n            Templates.renderForPromise('local_shopping_cart/shopping_cart_items', data).then(({html}) => {\r\n                document.querySelector('.shopping-cart-items').remove();\r\n                let container = document.querySelector('#nav-shopping_cart-popover-container .shopping-cart-items-container');\r\n                container.insertAdjacentHTML('afterbegin', html);\r\n                data.items.forEach(item => {\r\n                    buttoninit(item.itemid, item.itemcomponent);\r\n                });\r\n                let deleteaction = document.querySelectorAll('.fa-trash-o');\r\n                deleteaction.forEach(item => {\r\n                    addDeleteevent(item);\r\n                });\r\n                let itemcount = document.getElementById(\"itemcount\");\r\n                itemcount.innerHTML = data.count;\r\n                document.getElementById(\"countbadge\").innerHTML = data.count;\r\n                if (data.count > 0) {\r\n                    itemcount.classList.remove(\"hidden\");\r\n                } else {\r\n                    itemcount.classList.add(\"hidden\");\r\n                }\r\n                initTimer(data.expirationdate);\r\n\r\n                return true;\r\n            }).catch((e) => {\r\n                // eslint-disable-next-line no-console\r\n                console.log(e);\r\n            });\r\n        },\r\n        fail: function(ex) {\r\n            // eslint-disable-next-line no-console\r\n            console.log(\"ex:\" + ex);\r\n        },\r\n    }]);\r\n};\r\n\r\nexport const deleteAllItems = () => {\r\n    Ajax.call([{\r\n        methodname: \"local_shopping_cart_delete_all_items_from_cart\",\r\n        args: {\r\n        },\r\n        done: function() {\r\n            let item = document.querySelectorAll('[id^=item-]');\r\n            item.forEach(item => {\r\n                if (item) {\r\n                    item.remove();\r\n                }\r\n            });\r\n\r\n            updateTotalPrice();\r\n\r\n            let itemcount1 = document.getElementById(\"countbadge\");\r\n            let itemcount2 = document.getElementById(\"itemcount\");\r\n\r\n            itemcount1.innerHTML = 0;\r\n            itemcount2.innerHTML = 0;\r\n            itemcount2.classList.add(\"hidden\");\r\n\r\n            // Make sure addtocartbutton active againe once the item is removed from the shopping cart.\r\n            const addtocartbutton = document.querySelectorAll('[id^=btn-].disabled');\r\n            addtocartbutton.forEach(btn => {\r\n                if (btn) {\r\n                    btn.classList.remove('disabled');\r\n                }\r\n            });\r\n        },\r\n        fail: function(ex) {\r\n            // eslint-disable-next-line no-console\r\n            console.log(ex);\r\n        },\r\n    }]);\r\n};\r\n\r\nexport const deleteItem = (id, component, userid) => {\r\n\r\n    Ajax.call([{\r\n        methodname: \"local_shopping_cart_delete_item\",\r\n        args: {\r\n            'itemid': id,\r\n            'component': component,\r\n            'userid': userid\r\n        },\r\n        done: function() {\r\n\r\n            // We might display the item more often than once.\r\n            let items = document.querySelectorAll('#item-' + component + '-' + id);\r\n\r\n            items.forEach(item => {\r\n                if (item) {\r\n                    item.remove();\r\n                }\r\n            });\r\n\r\n            updateTotalPrice();\r\n\r\n            let itemcount1 = document.getElementById(\"countbadge\");\r\n            let itemcount2 = document.getElementById(\"itemcount\");\r\n\r\n            itemcount1.innerHTM = itemcount1.innerHTML > 0 ? itemcount1.innerHTML -= 1 : itemcount1.innerHTML;\r\n            itemcount2.innerHTML = itemcount2.innerHTML > 0 ? itemcount2.innerHTML -= 1 : itemcount1.innerHTML;\r\n\r\n            // If we have only one item left, we set back the expiration date.\r\n            if (itemcount2.innerHTML == 0) {\r\n                itemcount2.classList.add(\"hidden\");\r\n\r\n                // We clear the countdown and set back the timer.\r\n                clearInterval(interval);\r\n                initTimer();\r\n            }\r\n\r\n            // Make sure addtocartbutton active againe once the item is removed from the shopping cart.\r\n            const addtocartbutton = document.querySelector('#btn-' + component + '-' + id);\r\n            if (addtocartbutton) {\r\n                addtocartbutton.classList.remove('disabled');\r\n                buttoninit(id, component);\r\n            }\r\n        },\r\n        fail: function(ex) {\r\n            // eslint-disable-next-line no-console\r\n            console.log(id, ex);\r\n            let item = document.querySelector('#item-' + component + '-' + id);\r\n            if (item) {\r\n                item.remove();\r\n                let itemcount1 = document.getElementById(\"countbadge\");\r\n                let itemcount2 = document.getElementById(\"itemcount\");\r\n                itemcount1.innerHTML = itemcount1.innerHTML > 0 ? itemcount1.innerHTML -= 1 : itemcount1.innerHTML;\r\n                itemcount2.innerHTML = itemcount2.innerHTML > 0 ? itemcount2.innerHTML -= 1 : itemcount1.innerHTML;\r\n                itemcount2.innerHTML = itemcount2.innerHTML == 0 ? itemcount2.classList.add(\"hidden\") : itemcount2.innerHTML;\r\n                let itemprice = item.dataset.price;\r\n\r\n                // eslint-disable-next-line no-console\r\n                console.log('itemprice', itemprice);\r\n\r\n                updateTotalPrice();\r\n            }\r\n        },\r\n    }]);\r\n};\r\n\r\nexport const addItem = (id, component) => {\r\n\r\n    Ajax.call([{\r\n        methodname: \"local_shopping_cart_add_item\",\r\n        args: {\r\n            'component': component,\r\n            'itemid': id\r\n        },\r\n        done: function(data) {\r\n            data.component = component;\r\n            data.id = id;\r\n            data.userid = data.buyforuser; // For the mustache template, we need to obey structure.\r\n\r\n            // eslint-disable-next-line no-console\r\n            console.log('buyforuser', data.buyforuser);\r\n\r\n            if (data.success != 1) {\r\n                Notification.addNotification({\r\n                    message: \"Cart is full\",\r\n                    type: \"danger\"\r\n                });\r\n                setTimeout(() => {\r\n                    let notificationslist = document.querySelectorAll('#user-notifications div.alert.alert-danger');\r\n                    const notificatonelement = notificationslist[notificationslist.length - 1];\r\n                    notificatonelement.remove();\r\n                }, 5000);\r\n                return;\r\n            } else if (data.success == 1) {\r\n                Notification.addNotification({\r\n                    message: data.itemname + \" added to cart\",\r\n                    type: \"success\"\r\n                });\r\n\r\n                setTimeout(() => {\r\n                    let notificationslist = document.querySelectorAll('#user-notifications div.alert.alert-success');\r\n\r\n                    const notificatonelement = notificationslist[notificationslist.length - 1];\r\n\r\n                    notificatonelement.remove();\r\n                }, 5000);\r\n\r\n                Templates.renderForPromise('local_shopping_cart/shopping_cart_item', data).then(({html}) => {\r\n                    let lastElem = document.querySelectorAll(\"[id^='litotalprice']\");\r\n                    lastElem.forEach(lastElem => {\r\n                        // If we buy for a user, we only want to interact with the cashiers section.\r\n                        if ((data.buyforuser == 0)\r\n                            || (lastElem.id === \"litotalprice_cashier\")) {\r\n                            lastElem.insertAdjacentHTML('beforeBegin', html);\r\n                        }\r\n                    });\r\n\r\n                    // Make sure addtocartbutton is disabled once the item is in the shopping cart.\r\n                    const addtocartbutton = document.querySelector('#btn-' + component + '-' + data.itemid);\r\n                    if (addtocartbutton) {\r\n                        addtocartbutton.classList.add('disabled');\r\n                        addtocartbutton.removeEventListener('click', deleteEvent);\r\n                    }\r\n\r\n                    let items = document.querySelectorAll('#item-' + component + '-' + data.itemid + ' .fa-trash-o');\r\n                    items.forEach(item => {\r\n                        // eslint-disable-next-line no-console\r\n                        console.log('add delete event', item);\r\n                        // eslint-disable-next-line no-console\r\n                        console.log('userid ', data.userid);\r\n                        addDeleteevent(item, data.userid);\r\n                    });\r\n\r\n                    updateTotalPrice();\r\n\r\n                    // If we buy for a user, we don't have to do the navbar stuff below.\r\n                    if (data.buyforuser != 0) {\r\n                        return;\r\n                    }\r\n                    document.getElementById(\"countbadge\").innerHTML++;\r\n                    const badge = document.getElementById(\"itemcount\");\r\n                    badge.innerHTML = (parseInt(badge.innerHTML) || 0) + 1;\r\n                    badge.classList.remove('hidden');\r\n                    updateTotalPrice();\r\n                    clearInterval(interval);\r\n                    initTimer(data.expirationdate);\r\n                    return;\r\n                }).catch((e) => {\r\n                    // eslint-disable-next-line no-console\r\n                    console.log(e);\r\n                });\r\n            }\r\n        },\r\n        fail: function(ex) {\r\n            // eslint-disable-next-line no-console\r\n            console.log('error', ex);\r\n        }\r\n    }], true);\r\n};\r\n\r\n/**\r\n * Delete Event.\r\n * @param {HTMLElement} item\r\n * @param {int} userid\r\n */\r\nfunction addDeleteevent(item, userid = 0) {\r\n    if (userid != 0) {\r\n        item.dataset.userid = userid;\r\n    }\r\n    item.addEventListener('click', deleteEvent);\r\n}\r\n\r\n/**\r\n * Function called in listener,\r\n * @param {HTMLElement} item\r\n */\r\nfunction deleteEvent() {\r\n\r\n        const item = this;\r\n        // eslint-disable-next-line no-console\r\n        console.log('item', item);\r\n        // Item comes as #item-booking-213123.\r\n        const idarray = item.dataset.id.split('-');\r\n\r\n        // eslint-disable-next-line no-console\r\n        console.log('idarray', idarray);\r\n        // First pop gets the id.\r\n        const id = idarray.pop();\r\n        // Second pop gets the component.\r\n        const component = idarray.pop();\r\n        let userid = parseInt(item.dataset.userid);\r\n\r\n        if (!userid) {\r\n            userid = 0;\r\n        }\r\n\r\n        deleteItem(id, component, userid);\r\n    }\r\n\r\n    /**\r\n     * Function to update total price in navbar and for cashier.\r\n     */\r\n    function updateTotalPrice() {\r\n\r\n        let shoppingcart = document.querySelector('#shopping_cart-cashiers-cart');\r\n        let cashierssection = null;\r\n        let checkoutcart = null;\r\n        let checkouttotals = null;\r\n\r\n        if (!shoppingcart) {\r\n            shoppingcart = document.querySelector('#nav-shopping_cart-popover-container');\r\n            checkoutcart = document.querySelector('div.checkoutgrid.checkout');\r\n            // eslint-disable-next-line no-console\r\n            console.log('1', checkoutcart);\r\n        } else {\r\n            cashierssection = document.querySelector('#shopping_cart-cashiers-section');\r\n        }\r\n\r\n        const items = shoppingcart.querySelectorAll('[id^=item-]');\r\n        let totalprice = 0;\r\n        let currency = \"\";\r\n\r\n        items.forEach((item) => {\r\n            if (item.dataset.price) {\r\n                totalprice += parseInt(item.dataset.price);\r\n            }\r\n            currency = item.dataset.currency;\r\n        });\r\n        let totals = [];\r\n        if (cashierssection) {\r\n            totals = cashierssection.querySelectorAll('.totalprice');\r\n        } else {\r\n            // First we add the total price from navbar.\r\n            totals = shoppingcart.querySelectorAll('.totalprice');\r\n\r\n            // If we are on the checkout site, we deal with the totals there separately.\r\n            if (checkoutcart) {\r\n                checkouttotals = checkoutcart.querySelectorAll('.totalprice');\r\n\r\n                if (checkouttotals) {\r\n                    checkouttotals.forEach(total => {\r\n                        total.innerHTML = totalprice + \" \" + currency;\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        // Run through the list of total prices and set them to the right one.\r\n        totals.forEach(total => {\r\n            total.innerHTML =  totalprice + \" \" + currency;\r\n        });\r\n    }\r\n\r\n/**\r\n * Start the timer.\r\n *\r\n * @param {integer} duration\r\n * @param {integer} display\r\n */\r\nfunction startTimer(duration, display) {\r\n\r\n    var timer = duration,\r\n                minutes,\r\n                seconds;\r\n    interval = setInterval(function() {\r\n\r\n        minutes = parseInt(timer / 60, 10);\r\n        seconds = parseInt(timer % 60, 10);\r\n\r\n        minutes = minutes < 10 ? \"0\" + minutes : minutes;\r\n        seconds = seconds < 10 ? \"0\" + seconds : seconds;\r\n\r\n        display.textContent = minutes + \":\" + seconds;\r\n\r\n        if (--timer < 0) {\r\n            deleteAllItems();\r\n\r\n            clearInterval(interval);\r\n        }\r\n    }, 1000);\r\n}\r\n\r\n\r\n/**\r\n * Initialize Timer.\r\n *\r\n * @param {integer} expirationdate\r\n *\r\n */\r\nfunction initTimer(expirationdate = null) {\r\n    if (interval) {\r\n        clearInterval(interval);\r\n    }\r\n    let delta = 0;\r\n    let now = Date.now('UTC');\r\n    now = (new Date()).getTime() / 1000;\r\n    if (expirationdate) {\r\n        delta = (expirationdate - now);\r\n    }\r\n    if (delta <= 0) {\r\n        delta = 0;\r\n        countdownelement.classList.add(\"hidden\");\r\n    } else if (delta > 0) {\r\n        countdownelement.classList.remove(\"hidden\");\r\n        startTimer(delta, countdownelement);\r\n    }\r\n}\r\n\r\n"],"file":"cart.min.js"}