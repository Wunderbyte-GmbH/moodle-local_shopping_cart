define ("local_shopping_cart/cart",["exports","core/ajax"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.addItem=a.deleteItem=a.init=a.buttoninit=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);a.buttoninit=function buttoninit(a,b){console.log("initialized",a,b);var c=document.querySelector("#btn-"+b+"-"+a);if(!c){return}c.querySelector(".loadJavascript").remove();var d=c.querySelector("span");if(d){d.classList.remove("hidden")}var e=document.querySelector("#nav-shopping_cart-popover-container");if(e){var f=e.querySelector("#item-"+b+"-"+a);if(f){c.classList.add("disabled")}}c.addEventListener("click",function(d){if(c.classList.contains("disabled")){return}d.preventDefault();d.stopPropagation();g(a,b)})};a.init=function init(){document.querySelectorAll(".shopping-cart-items [id^=item]").forEach(function(a){console.log(a.dataset.expirationdate+" asd a"+a.dataset.id);e(a.dataset.expirationdate,a.dataset.id,a.dataset.component)});document.querySelectorAll(".fa-trash-o").forEach(function(a){c(a)})};var f=function(a,c){b.default.call([{methodname:"local_shopping_cart_delete_item",args:{itemid:a,component:c},done:function done(){console.log(a);var b=document.querySelector("#item-"+c+"-"+a);if(b){b.remove();var d=document.getElementById("countbadge"),e=document.getElementById("itemcount");d.innerHTML=0<d.innerHTML?d.innerHTML-=1:d.innerHTML;e.innerHTML=0<e.innerHTML?e.innerHTML-=1:d.innerHTML;e.innerHTML=0==e.innerHTML?e.classList.add("hidden"):e.innerHTML;var f=b.dataset.price,g=document.getElementById("totalprice");g="undefined"==g?0:g;g.innerHTML-=f;var h=document.querySelector("#btn-"+c+"-"+a);if(h){h.classList.remove("disabled")}}},fail:function fail(b){console.log(a,b);var d=document.querySelector("#item-"+c+"-"+a);if(d){d.remove();var e=document.getElementById("countbadge"),f=document.getElementById("itemcount");e.innerHTML=0<e.innerHTML?e.innerHTML-=1:e.innerHTML;f.innerHTML=0<f.innerHTML?f.innerHTML-=1:e.innerHTML;f.innerHTML=0==f.innerHTML?f.classList.add("hidden"):f.innerHTML;var g=d.dataset.price,h=document.getElementById("totalprice");h="undefined"==h?0:h;h.innerHTML-=g}}}])};a.deleteItem=f;var g=function(a,d){b.default.call([{methodname:"local_shopping_cart_add_item",args:{component:d,itemid:a},done:function done(a){var b="<li id=\"item-"+d+"-"+a.itemid+"\" class=\"clearfix\" data-price=\""+a.price+"\" data-name=\""+a.itemname+"\" data-component=\""+d+"\"><span class=\"item-name\"><i class=\"fa fa-futbol-o\" aria-hidden=\"true\"></i>"+a.itemname+"</span><span class=\"item-price pull-right\">"+a.price+" "+a.currency+"</span><br><span class=\"item-time pl-3\">[<span id=\"time-item-"+d+"-"+a.itemid+"\"></span>]</span><span class=\"pull-right\"><i class=\"fa fa-trash-o lighter-text\"data-id=\"item-"+d+"-"+a.itemid+"\"></i></span></li>",f=document.getElementById("litotalprice");f.insertAdjacentHTML("beforeBegin",b);document.getElementById("countbadge").innerHTML++;var g=document.getElementById("itemcount");g.innerHTML++;g.classList.remove("hidden");var h=document.getElementById("totalprice");h.innerHTML=parseInt(h.innerHTML)+parseInt(a.price);c(document.querySelector("#item-"+d+"-"+a.itemid+" .fa-trash-o"));e(a.expirationdate,a.itemid,d);var i=document.querySelector("#btn-"+d+"-"+a.itemid);if(i){i.classList.add("disabled")}},fail:function fail(a){console.log("error",a)}}],!0)};a.addItem=g;function c(a){a.addEventListener("click",function(b){b.preventDefault();b.stopPropagation();console.log("delete clicked",a.dataset.id);var c=a.dataset.id.split("-"),d=c.pop(),e=c.pop();f(d,e)})}function d(a,b,c,d){var e=a,g,h,i=setInterval(function(){g=parseInt(e/60,10);h=parseInt(e%60,10);g=10>g?"0"+g:g;h=10>h?"0"+h:h;b.textContent=g+":"+h;if(0>--e){e=0;f(c,d);clearInterval(i)}},1e3)}function e(a,b,c){var e=0,f=Date.now("UTC");f=new Date().getTime()/1e3;e=a-f;if(0>e){e=0}var g=document.querySelector("#time-item-"+c+"-"+b);if(g){d(e,g,b,c)}}});
//# sourceMappingURL=cart.min.js.map
