define ("local_shopping_cart/cashier",["exports","core/ajax","core/url"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.autocomplete=a.validateCart=a.confirmPayment=a.init=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}a.init=function init(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;console.log("run init",b);document.getElementById("checkout-tab").classList.remove("success");var c=document.querySelector("#buy-btn");console.log(c);if(c){c.addEventListener("click",function(){e(b)})}var d=document.querySelector("#checkout-btn");console.log(d);if(d){d.addEventListener("click",function(){document.getElementById("checkout-tab").classList.add("success");console.log("click")})}f(document.getElementById("searchuser"),a);(function(){var b=document.querySelector("#shoppingcartfilterinput");b.addEventListener("keyup",function(){for(var c=b.value.toUpperCase(),d=document.querySelectorAll(".list-group-item.wunderbyteTableJavascript"),e=0;e<d.length;e++){var f=d[e],a=f.textContent||f.innerText;if(-1<a.toUpperCase().indexOf(c)){d[e].style.display=""}else{d[e].style.display="none"}}})})()};var e=function(a){b.default.call([{methodname:"local_shopping_cart_confirm_cash_payment",args:{userid:a},done:function done(a){if(1==a.status){console.log("payment confirmed",a);var e=window.location.href.indexOf("cashier.php");if(1>e){var b=a.identifier,d=c.default.fileUrl("/local/shopping_cart/checkout.php?success=1&identifier="+b,"");location.href=d}else{document.getElementById("success-tab").classList.add("success");if(a.credit){var f=document.querySelector("span.credit_total");f.innerText=a.credit}var g=document.querySelectorAll("#shopping_cart-cashiers-cart ul.shopping-cart-items li.clearfix");g.forEach(function(a){console.log(a);if(a){a.remove()}});var h=document.querySelectorAll("#shopping_cart-cashiers-cart .initialtotal");h.forEach(function(a){console.log(a);if(a){a.innerText=0}})}}else{console.log("payment denied");document.getElementById("success-tab").classList.add("error")}},fail:function fail(a){console.log(a)}}])};a.confirmPayment=e;a.validateCart=function validateCart(a){alert(a)};var f=function(a,c){var g,h=document.querySelector("#useridfield");a.addEventListener("input",function(){var d,e,j,k=this.value;f();if(!k){return!1}g=-1;d=document.createElement("DIV");d.setAttribute("id",this.id+"autocomplete-list");d.setAttribute("class","autocomplete-items");this.parentNode.appendChild(d);for(j=0;j<c.length;j++){if(-1<c[j].toUpperCase().indexOf(k.toUpperCase())){e=document.createElement("DIV");var l=c[j].toUpperCase().indexOf(k.toUpperCase());e.innerHTML=c[j].substr(0,l);e.innerHTML+="<strong>"+c[j].substr(c[j].toUpperCase().indexOf(k.toUpperCase()),k.length)+"</strong>";e.innerHTML+=c[j].substr(l+k.length);e.innerHTML+="<input type='hidden' value='"+c[j]+"'>";e.addEventListener("click",function(){a.value=this.getElementsByTagName("input")[0].value;h.value=this.getElementsByTagName("input")[0].value.split("uid:")[1];f()});d.appendChild(e)}}return null});a.addEventListener("keydown",function(a){var b=document.getElementById(this.id+"autocomplete-list");if(b){b=b.getElementsByTagName("div")}if(40==a.keyCode){g++;d(b)}else if(38==a.keyCode){g--;d(b)}else if(13==a.keyCode){a.preventDefault();if(-1<g){if(b){b[g].click()}}}});function d(a){if(!a){return}e(a);if(g>=a.length){g=0}if(0>g){g=a.length-1}a[g].classList.add("autocomplete-active")}function e(a){for(var b=0;b<a.length;b++){a[b].classList.remove("autocomplete-active")}}function f(b){for(var c=document.getElementsByClassName("autocomplete-items"),d=0;d<c.length;d++){if(b!=c[d]&&b!=a){c[d].parentNode.removeChild(c[d])}}}document.addEventListener("click",function(a){f(a.target)})};a.autocomplete=f});
//# sourceMappingURL=cashier.min.js.map
